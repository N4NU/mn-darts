{% extends "base.html" %}
{% block content %}
<div class="container">
  <h3>掲示板</h3>

  <div class="row">
    <div class="col-md-8">
      {% if thread_list %}
      {% for thread_id, thread_title, thread_description in thread_list %}
      <div class="panel panel-default">
        <div class="panel-heading"><a href="{{ url_for('bbs_view_thread', thread_id=thread_id) }}">{{ thread_title }}</a></div>
        <div class="panel-body">{{ thread_description }}</div>
      </div>
      {% endfor %}
      {% endif %}
      <ul class="pagination pagination-lg">
        {% if pagination.current_page == 0 %}
          <li class="disabled"><a href="#">Prev</a></li>
        {% else %}
          <li><a href="{{ url_for('bbs', page=pagination.current_page - 1) }}">Prev</a></li>
        {% endif %}


        {% if pagination.current_page == 0 %}
          <li class="active"><a href="{{ url_for('bbs', p=0) }}">1</a></li>
          {% if pagination.num_page < 5 %}
            {% for idx in range(1, pagination.num_page) %}
              <li><a href="{{ url_for('bbs', p=idx) }}">{{ idx + 1 }}</a></li>
            {% endfor %}
            {% for idx in range(pagination.num_page, 5) %}
              <li class="disabled"><a href="#">{{ idx + 1 }}</a></li>
            {% endfor %}
          {% else %}
            {% for idx in range(1, 5) %}
              <li><a href="{{ url_for('bbs', p=idx) }}">{{ idx + 1 }}</a></li>
            {% endfor %}
          {% endif %}
        {% elif pagination.current_page == 1 %}
          <li><a href="{{ url_for('bbs', p=0) }}">1</a></li>
          <li class="active"><a href="{{ url_for('bbs', p=1) }}">2</a></li>
          {% if pagination.num_page < 5 %}
            {% for idx in range(2, pagination.num_page) %}
              <li><a href="{{ url_for('bbs', p=idx) }}">{{ idx + 1 }}</a></li>
            {% endfor %}
            {% for idx in range(pagination.num_page, 5) %}
              <li class="disabled"><a href="#">{{ idx + 1 }}</a></li>
            {% endfor %}
          {% else %}
            {% for idx in range(2, 5) %}
              <li><a href="{{ url_for('bbs', p=idx) }}">{{ idx + 1 }}</a></li>
            {% endfor %}
          {% endif %}
        {% elif pagination.current_page < pagination.num_page - 2 %}
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 2) }}">{{ pagination.current_page - 1 }}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 1) }}">{{ pagination.current_page }}</a></li>
          <li class="active"><a href="{{ url_for('bbs', p=pagination.current_page) }}">{{ pagination.current_page + 1 }}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page + 1) }}">{{ pagination.current_page + 2 }}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page + 2) }}">{{ pagination.current_page + 3 }}</a></li>
        {% elif pagination.num_page - 2 == pagination.current_page %}
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 3) }}">{{ pagination.current_page - 2 }}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 2) }}">{{ pagination.current_page - 1 }}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 1) }}">{{ pagination.current_page }}</a></li>
          <li class="active"><a href="{{ url_for('bbs', p=pagination.current_page) }}">{{ pagination.current_page + 1 }}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page + 1) }}">{{ pagination.current_page + 2 }}</a></li>
        {% elif pagination.num_page - 1 == pagination.current_page %}
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 4) }}">{{ pagination.current_page - 3 }}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 3) }}">{{ pagination.current_page - 2 }}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 2) }}">{{ pagination.current_page - 1}}</a></li>
          <li><a href="{{ url_for('bbs', p=pagination.current_page - 1) }}">{{ pagination.current_page }}</a></li>
          <li class="active"><a href="{{ url_for('bbs', p=pagination.current_page) }}">{{ pagination.current_page + 1 }}</a></li>
        {% endif %}

        {% if pagination.num_page - 1 == pagination.current_page %}
          <li class="disabled"><a href="#">Next</a></li>
        {% else %}
          <li><a href="{{ url_for('bbs', p=pagination.current_page + 1) }}">Next</a></li>
        {% endif %}
      </ul>
    </div>
    <div class="col-md-4">
      <form action="{{ url_for('bbs') }}" method="GET" role="form">
        <div class="input-group">
          <input type="text" class="form-control" name="q">
          <span class="input-group-btn">
            <button class="btn btn-primary" type="submit">検索</button>
          </span>
        </div>
      </form>
      <hr />
      <a href="{{ url_for('bbs_create_thread') }}" class="btn btn-primary">新しくスレッドを作る</a>
    </div>
  </div>


</div>
{% endblock %}